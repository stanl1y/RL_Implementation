<div id="top"></div>
<br />
<div align="center">
  <h1 align="center">TDIL (Imitation Learning via Transition Discriminator)</h1>
</div>

## Preparation
* This project can be executed with Python 3.7.7.
* Install the required packages by running the following command:
```bash
pip install -r requirements.txt
```

## Expert data
### Path to expert data
The expert data is stored in the folder `saved_expert_transition/`. The expert data is generated by a trained SAC agent and is stored in dictionary format with the following keys: "states", "actions", "rewards", "next_states", "dones". The value of each keys contains a numpy array.

### Score of expert data
* Hopper-v3: 4114
* Walker-v3: 6123
* Ant-v3: 6561
* HalfCheetah-v3: 15251
* Humanoid-v3: 5855


## Scripts
### Normal TDIL
* Hopper-v3:
    ```
    python main.py --main_stage neighborhood_il --main_task neighborhood_sac --env Hopper-v3 --wrapper basic --episode 5000 --data_name sac/episode_num1
    ``` 
    * Fix alpha:
        ```
        add
        --no_update_alpha --log_alpha_init -4.6
        ```

* Walker-v3:
    ```
    python main.py --main_stage neighborhood_il --main_task neighborhood_sac --env Walker2d-v3 --wrapper basic --episode 5000 --data_name sac/episode_num1
    ```
    * Fix alpha:
        ```
        add
        --no_update_alpha --log_alpha_init -1.2
        ```

* Ant-v3:
    ```
    python main.py --main_stage neighborhood_il --main_task neighborhood_sac --env Ant-v3 --wrapper basic --episode 10000 --data_name sac/episode_num1 --terminate_when_unhealthy
    ```
    * Fix alpha:
        ```
        add
        --no_update_alpha --log_alpha_init -1.9
        ```

* HalfCheetah-v3:
    ```
    python main.py --main_stage neighborhood_il --main_task neighborhood_sac --env HalfCheetah-v3 --wrapper basic --episode 5000 --data_name sac/episode_num1
    ``` 
    * Fix alpha:
        ```
        add
        --no_update_alpha --log_alpha_init 0.4
        ```

* Humanoid-v3:
    ```
    python main.py --main_stage neighborhood_il --main_task neighborhood_sac --env Humanoid-v3 --wrapper basic --episode 25000 --data_name sac/episode_num1 --terminate_when_unhealthy
    ``` 
    * Fix alpha:
        ```
        add
        --no_update_alpha --log_alpha_init -0.6
        ```

### Run without BC loss
Add the following flag:
```
--no_bc
```

### Run without hard negative sampling
Add the following flag:
```
--no_hard_negative_sampling
```